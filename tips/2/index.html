<!DOCTYPE html>
<html>
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
    <title>ディレクター向けプログラミング勉強会 | 文字コードとWindowsでの日本語の扱い</title><link href="/programming-workshop/stylesheets/site.css" rel="stylesheet" />
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/programming-workshop/">ディレクター向け勉強会</a>
        </div>
        <div id="navbar-collapse" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li>
              <a href="/programming-workshop/">Top</a>
            </li>
            <li>
              <a href="/programming-workshop/tips/">Tips</a>
            </li>
          </ul>
        </div>
      </div>
    </nav><div class="container">
  <h1>
    ディレクター向け勉強会 | Tips
  </h1>
  <h2>
    文字コードとWindowsでの日本語の扱い
  </h2><h3>
  文字コード
</h3>
<p>
  文字コードとは、文字と数字のマッピングルールです。以下の様に個々の文字を数字で表すルールが決められており、コンピュータ上ではこの数字を処理しています。
</p>
<table class="table">
  <thead>
    <tr>
      <th>
        文字
      </th>
      <th>
        数字
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        A
      </td>
      <td>
        65
      </td>
    </tr>
    <tr>
      <td>
        B
      </td>
      <td>
        66
      </td>
    </tr>
    <tr>
      <td>
        C
      </td>
      <td>
        67
      </td>
    </tr>
  </tbody>
</table>
<p>
  コンピュータは英語圏で生まれたツールですので、アルファベット・数字・幾つかの基本的な記号については、全世界で共通のマッピングルールが用いられています。
</p>
<p>
  しかし、最初にアメリカでマッピングルールが決められなかった文字については、残念ながら世界で唯一のマッピングルールが定まっていません。日本語も、幾つかの文字コードが作られてしまいました。Shift-JISやEUC-JP、ISO-2022-JPなどです。
</p>
<h3>
  文字コードのズレ
</h3>
<p>
  複数の文字コードが存在する場合、「今どの文字コードを使っているのか」を意識しないと、問題が発生します。
</p>
<p>
  例えば、以下の2つの文字コードがあったとします。
</p>
<table class="table">
  <thead>
    <tr>
      <th>
        文字
      </th>
      <th>
        文字コードAでマッピングした数字
      </th>
      <th>
        文字コードBでマッピングした数字
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        あ
      </td>
      <td>
        101
      </td>
      <td>
        103
      </td>
    </tr>
    <tr>
      <td>
        い
      </td>
      <td>
        102
      </td>
      <td>
        104
      </td>
    </tr>
    <tr>
      <td>
        う
      </td>
      <td>
        103
      </td>
      <td>
        105
      </td>
    </tr>
  </tbody>
</table>
<p>
  もし、文字コードAを使っているプログラムと文字コードBを使っているプログラムを連携させてしまうと、文字コードズレによる問題が発生してしまうわけです。これが、いわゆる文字化けと呼ばれる現象です。
</p>
<p>
  <img class="img-responsive" src="/programming-workshop/images/tips/2/encoding.png" />
</p>
<p>
  これを防ぐためには、適切に文字コードの変換を挟む等のやり方もあるのですが、最も簡単な手段は「関連するプログラムの文字コードを一致させる」という方法です。上の例でも、プログラムAとBが同じ文字コードを使っていれば、問題は発生しないわけです。
</p>
<h3>
  WindowsのコマンドプロンプトでRubyを動かす時の問題
</h3>
<p>
  で、Windowsでコマンドプロンプト経由でRubyを動かすときに、この文字化け問題が起きてしまう可能性があります。
</p>
<p>
  WindowsでコマンドプロンプトからRubyプログラムを起動した場合、コマンドプロンプトとRubyプログラムが連携して動きます。ユーザが文字を入力すると、その入力はコマンドプロンプトに渡り、コマンドプロンプトがRubyプログラムにそのデータを引き渡すわけです。ですので、コマンドプロンプトとRubyプログラムで、同じ文字コードを使わせてやる必要があります。
</p>
<p>
  コマンドプロンプトは固定でShift-JISを使います。従って、RubyプログラムにもShift-JISを使わせてやるのがよいということになります。
</p>
<h3>
  実際にRubyプログラムにShift−JISを使わせる方法
</h3>
<p>
  RubyプログラムにShift-JISを使わせるには以下の2つが必要です。
</p>
<ol>
  <li>
    ソースコードをShift-JISで書く
  </li>
  <li>
    プログラム実行時に文字コードを指定するオプションを付ける
  </li>
</ol>
<h4>
  ソースコードをShift-JISで書く
</h4>
<p>
  これは使ってるエディタ次第なので、ググるとかして、「Shift-JISとしてファイルを保存」してください。
</p>
<h4>
  プログラム実行時に文字コードを指定するオプションを付ける
</h4>
<p>
  Rubyプログラムは、何も指定しなければ、デフォルトでUTF-8を使うようになっています。そのため、Shift-JISを使いたい場合には、以下のように「-Ks」を付けて、Shift-JISを使うように指示をしてやります。
</p>
<pre class="well">ruby -Ks program.rb</pre>
<h3>
  ちなみにMac、Linuxの場合
</h3>
<p>
  Mac、Linuxの場合は、最近はだいたいなんでもデフォルトでUTF-8なので、あまり気にしなくても勝手にUTF-8に統一され、問題は起こらないと思います。
</p>
</div><script src="/programming-workshop/javascripts/application.js"></script>
  </body>
</html>